(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[667],{2523:(e,t,a)=>{"use strict";a.d(t,{p:()=>i});var s=a(5155),r=a(2115),n=a(9434);let i=r.forwardRef((e,t)=>{let{className:a,type:r,...i}=e;return(0,s.jsx)("input",{type:r,className:(0,n.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:t,...i})});i.displayName="Input"},3195:(e,t,a)=>{Promise.resolve().then(a.bind(a,4049))},3330:(e,t,a)=>{"use strict";a.d(t,{U:()=>f});var s=a(5155),r=a(285),n=a(4838),i=a(4469),l=a(7481),c=a(2298),o=a(4815),d=a(1721),u=a(3349),m=a(6766),h=a(6874),x=a.n(h),p=a(5695);function f(){let{user:e,logout:t}=(0,c.useAuth)(),{items:a}=(0,i._)();(0,p.usePathname)();let h=(0,p.useRouter)(),{toast:f}=(0,l.dj)(),g=async()=>{try{await t(),f({title:"Logged Out",description:"You have been successfully logged out."}),h.push("/")}catch(e){f({variant:"destructive",title:"Logout Failed",description:"Please try again."})}},y=()=>a.reduce((e,t)=>e+t.quantity,0);return(0,s.jsx)("header",{className:"bg-background/95 backdrop-blur-sm sticky top-0 z-40 border-b shadow-sm",children:(0,s.jsxs)("div",{className:"container mx-auto px-4 flex justify-between items-center h-16",children:[(0,s.jsxs)(x(),{href:"/",className:"flex items-center gap-2 hover:opacity-80 transition-opacity",children:[(0,s.jsx)(m.default,{src:"https://placehold.co/40x40.png",width:40,height:40,alt:"TumbleBunnies Logo","data-ai-hint":"bunny logo"}),(0,s.jsx)("span",{className:"font-headline text-2xl font-bold text-primary",children:"TumbleBunnies"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsxs)(r.$,{variant:"ghost",size:"icon",className:"relative cursor-pointer","aria-label":"Shopping Cart",onClick:()=>{console.log("Cart clicked, navigating to checkout..."),h.push("/checkout")},children:[(0,s.jsx)(o.A,{className:"h-5 w-5"}),y()>0&&(0,s.jsx)("span",{className:"absolute -top-1 -right-1 bg-primary text-primary-foreground rounded-full h-5 w-5 text-xs flex items-center justify-center font-medium",children:y()})]}),e&&(0,s.jsxs)(n.rI,{children:[(0,s.jsx)(n.ty,{asChild:!0,children:(0,s.jsx)(r.$,{variant:"ghost",size:"icon","aria-label":"User Account",children:(0,s.jsx)(d.A,{className:"h-5 w-5"})})}),(0,s.jsxs)(n.SQ,{align:"end",className:"w-56",children:[(0,s.jsx)(n.lp,{className:"font-normal",children:(0,s.jsxs)("div",{className:"flex flex-col space-y-1",children:[(0,s.jsx)("p",{className:"text-sm font-medium leading-none",children:e.email}),(0,s.jsx)("p",{className:"text-xs leading-none text-muted-foreground",children:e.displayName||"User"})]})}),(0,s.jsx)(n.mB,{}),(0,s.jsx)(n._2,{asChild:!0,children:(0,s.jsxs)(x(),{href:"/account",className:"flex items-center gap-2",children:[(0,s.jsx)(d.A,{className:"h-4 w-4"}),"My Profile"]})}),(0,s.jsx)(n._2,{asChild:!0,children:(0,s.jsxs)(x(),{href:"/orders",className:"flex items-center gap-2",children:[(0,s.jsx)(o.A,{className:"h-4 w-4"}),"My Orders"]})}),(0,s.jsx)(n.mB,{}),(0,s.jsxs)(n._2,{onSelect:g,className:"text-destructive focus:text-destructive",children:[(0,s.jsx)(u.A,{className:"h-4 w-4 mr-2"}),"Logout"]})]})]})]})]})})}},3349:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(157).A)("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]])},4049:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>h});var s=a(5155),r=a(3330),n=a(285),i=a(6695),l=a(2523),c=a(7481),o=a(2298),d=a(5317),u=a(5695),m=a(2115);function h(){let e=(0,u.useParams)(),t=Array.isArray(null==e?void 0:e.facilityId)?e.facilityId[0]:null==e?void 0:e.facilityId,h=(0,u.useRouter)(),{user:x}=(0,o.useAuth)(),{toast:p}=(0,c.dj)(),[f,g]=(0,m.useState)(null),[y,j]=(0,m.useState)(!0),[N,v]=(0,m.useState)({parentName:"",parentPhone:"",parentEmail:(null==x?void 0:x.email)||"",password:"",confirmPassword:"",numChildren:1,children:[""]}),[b,w]=(0,m.useState)(!1);function C(e){let{name:t,value:a,type:s}=e.target;"numChildren"===t?v(e=>({...e,numChildren:Number(a)})):"parentPhone"===t?v(e=>({...e,parentPhone:function(e){let t=e.replace(/\D/g,"").match(/^(\d{0,3})(\d{0,3})(\d{0,4})$/);if(!t)return e;let a="";return t[1]&&(a="(".concat(t[1])),t[2]&&(a+=3===t[2].length?") ".concat(t[2]):t[2]),t[3]&&(a+=t[3]?"-".concat(t[3]):""),a}(a)})):v(e=>({...e,[t]:a}))}async function P(e){if(e.preventDefault(),N.password!==N.confirmPassword)return void p({variant:"destructive",title:"Passwords Don't Match",description:"Please make sure your passwords match."});if(N.password.length<6)return void p({variant:"destructive",title:"Password Too Short",description:"Password must be at least 6 characters long."});w(!0);try{let{createUserWithEmailAndPassword:e}=await Promise.resolve().then(a.bind(a,3004)),s=await e((await Promise.resolve().then(a.bind(a,2298))).auth,N.parentEmail,N.password);await (0,d.gS)((0,d.rJ)(o.db,"registrations"),{parentName:N.parentName,parentPhone:N.parentPhone,parentEmail:N.parentEmail,facilityId:t,facilityName:(null==f?void 0:f.name)||"",children:N.children,createdAt:Date.now(),userId:s.user.uid}),p({title:"Registration Successful!",description:"Your account has been created and you're registered. Redirecting to your classes..."}),setTimeout(()=>{h.replace("/classes/".concat(t))},2e3)}catch(t){let e="Registration failed. Please try again.";"auth/email-already-in-use"===t.code?e="An account with this email already exists. Please sign in instead.":"auth/weak-password"===t.code?e="Password is too weak. Please choose a stronger password.":"auth/invalid-email"===t.code&&(e="Please enter a valid email address."),p({variant:"destructive",title:"Registration Failed",description:e})}finally{w(!1)}}return(0,m.useEffect)(()=>{!async function(){if(!t)return;j(!0);let e=await (0,d.x7)((0,d.H9)(o.db,"facilities",t));e.exists()&&g({id:e.id,...e.data()}),j(!1)}()},[t]),(0,m.useEffect)(()=>{v(e=>{let t=[...e.children||[]];if(e.numChildren>t.length)for(let a=t.length;a<e.numChildren;a++)t.push("");else e.numChildren<t.length&&(t.length=e.numChildren);return{...e,children:t}})},[N.numChildren]),y?(0,s.jsx)("div",{className:"flex justify-center items-center h-64",children:"Loading..."}):f?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(r.U,{}),(0,s.jsx)("main",{className:"container mx-auto px-4 py-12 max-w-3xl flex flex-col items-center justify-center text-center",children:(0,s.jsxs)(i.Zp,{className:"shadow-2xl",children:[(0,s.jsxs)(i.aR,{className:"text-center",children:[(0,s.jsxs)(i.ZB,{className:"font-headline text-2xl mb-2 text-center",children:["Register for ",f.name]}),(0,s.jsxs)("div",{className:"text-muted-foreground mb-2 text-center",children:["Facility Code: ",(0,s.jsx)("span",{className:"font-mono",children:f.registrationCode})]})]}),(0,s.jsx)(i.Wu,{children:(0,s.jsxs)("form",{className:"space-y-4 flex flex-col items-center justify-center text-center",onSubmit:P,children:[(0,s.jsx)(l.p,{name:"parentName",placeholder:"Parent Name",value:N.parentName,onChange:C,required:!0,className:"text-center"}),(0,s.jsx)(l.p,{name:"parentPhone",placeholder:"Phone Number",value:N.parentPhone,onChange:C,required:!0,className:"text-center"}),(0,s.jsx)(l.p,{name:"parentEmail",placeholder:"Email Address",value:N.parentEmail,onChange:C,required:!0,type:"email",className:"text-center"}),(0,s.jsx)(l.p,{name:"password",placeholder:"Password",value:N.password,onChange:C,required:!0,type:"password",className:"text-center"}),(0,s.jsx)(l.p,{name:"confirmPassword",placeholder:"Confirm Password",value:N.confirmPassword,onChange:C,required:!0,type:"password",className:"text-center"}),(0,s.jsxs)("div",{className:"w-full flex flex-col items-center",children:[(0,s.jsx)("label",{className:"block mb-1 font-medium text-center",children:"Number of Children Attending"}),(0,s.jsx)("select",{name:"numChildren",value:N.numChildren,onChange:C,className:"w-32 p-2 border rounded text-center mx-auto",children:[1,2,3,4,5].map(e=>(0,s.jsx)("option",{value:e,children:e},e))})]}),N.children.map((e,t)=>(0,s.jsx)(l.p,{placeholder:"Child ".concat(t+1," Name"),value:e,onChange:e=>{var a;return a=e.target.value,void v(e=>{let s=[...e.children];return s[t]=a,{...e,children:s}})},required:!0,className:"text-center"},t)),(0,s.jsx)(n.$,{type:"submit",className:"w-full",disabled:b,children:b?"Creating Account...":"Create Account & Register"})]})})]})})]}):(0,s.jsx)("div",{className:"text-center text-destructive",children:"Facility not found."})}},4815:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(157).A)("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]])}},e=>{var t=t=>e(e.s=t);e.O(0,[992,644,380,537,766,123,441,684,358],()=>t(3195)),_N_E=e.O()}]);