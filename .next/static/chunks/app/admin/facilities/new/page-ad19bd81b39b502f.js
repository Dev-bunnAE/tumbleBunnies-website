(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[335],{1303:(e,s,a)=>{Promise.resolve().then(a.bind(a,9197))},2773:(e,s,a)=>{"use strict";a.d(s,{A:()=>l});let l=(0,a(157).A)("FolderOpen",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]])},3349:(e,s,a)=>{"use strict";a.d(s,{A:()=>l});let l=(0,a(157).A)("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]])},9197:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>h});var l=a(5155),n=a(2204),i=a(7857),r=a(2298),t=a(5317),d=a(6874),c=a.n(d),o=a(5695),u=a(2115);function h(){let[e,s]=(0,u.useState)({name:"",address:"",phone:"",registrationCode:"",availablePairs:[],pricing:{}}),[a,d]=(0,u.useState)([]),[h,m]=(0,u.useState)({classId:"",sessionLength:5}),[p,x]=(0,u.useState)(!1),b=(0,o.useRouter)();function g(e){let{name:a,value:l,type:n}=e.target;if("checkbox"===n&&"sessionLengths"===a){let a=e.target.checked;s(e=>({...e,sessionLengths:a?[...e.sessionLengths,Number(l)]:e.sessionLengths.filter(e=>e!==Number(l))}))}else if("checkbox"===n&&"classIds"===a){let a=e.target.checked;s(e=>({...e,classIds:a?[...e.classIds,l]:e.classIds.filter(e=>e!==l)}))}else"phone"===a?s(e=>({...e,phone:function(e){let s=e.replace(/\D/g,"").match(/^(\d{0,3})(\d{0,3})(\d{0,4})$/);if(!s)return e;let a="";return s[1]&&(a="(".concat(s[1])),s[2]&&(a+=3===s[2].length?") ".concat(s[2]):s[2]),s[3]&&(a+=s[3]?"-".concat(s[3]):""),a}(l)})):s(e=>({...e,[a]:l}))}async function f(s){s.preventDefault(),x(!0);try{await (0,t.gS)((0,t.rJ)(r.db,"facilities"),e),await b.push("/admin/facilities")}catch(e){alert("Failed to save facility. Please try again."),x(!1)}}return(0,u.useEffect)(()=>{!async function(){let e=(await (0,t.GG)((0,t.rJ)(r.db,"classes"))).docs.map(e=>({id:e.id,...e.data()}));e.sort((e,s)=>e.name.localeCompare(s.name)),d(e)}()},[]),(0,l.jsx)(n.AdminAuthGuard,{children:(0,l.jsxs)("div",{children:[(0,l.jsx)(i.AdminHeader,{}),(0,l.jsxs)("main",{className:"container mx-auto px-4 py-12 max-w-xl",children:[(0,l.jsx)("h1",{className:"text-3xl font-headline font-bold text-primary mb-8 text-center",children:"Add Facility"}),(0,l.jsxs)("form",{className:"bg-card rounded-lg shadow-md p-6 space-y-4",onSubmit:f,children:[(0,l.jsx)("input",{className:"w-full p-2 border rounded",name:"name",placeholder:"Facility Name",value:e.name,onChange:g,required:!0}),(0,l.jsx)("input",{className:"w-full p-2 border rounded",name:"address",placeholder:"Address",value:e.address,onChange:g,required:!0}),(0,l.jsx)("input",{className:"w-full p-2 border rounded",name:"phone",placeholder:"Phone Number",value:e.phone,onChange:g,required:!0}),(0,l.jsx)("input",{className:"w-full p-2 border rounded",name:"registrationCode",placeholder:"Registration Code",value:e.registrationCode,onChange:g,required:!0}),(0,l.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,l.jsx)("span",{className:"font-semibold",children:"Class-Session Pairs"}),(0,l.jsx)("div",{className:"space-y-2 mb-2",children:0===e.availablePairs.length?(0,l.jsx)("span",{className:"text-muted-foreground",children:"No pairs added."}):e.availablePairs.map((e,n)=>{var i;let r=(null==(i=a.find(s=>s.id===e.classId))?void 0:i.name)||e.classId;return(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsxs)("span",{children:[r," â€“ ",e.sessionLength," weeks"]}),(0,l.jsx)("button",{type:"button",className:"text-destructive underline text-xs",onClick:()=>{s(e=>e&&{...e,availablePairs:e.availablePairs.filter((e,s)=>s!==n)})},children:"Remove"})]},n)})}),(0,l.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,l.jsxs)("select",{className:"p-2 border rounded",value:h.classId,onChange:e=>m(s=>({...s,classId:e.target.value})),children:[(0,l.jsx)("option",{value:"",disabled:!0,children:"Select Class"}),a.map(e=>(0,l.jsx)("option",{value:e.id,children:e.name},e.id))]}),(0,l.jsx)("select",{className:"p-2 border rounded",value:h.sessionLength,onChange:e=>m(s=>({...s,sessionLength:Number(e.target.value)})),children:[5,6,7,8].map(e=>(0,l.jsxs)("option",{value:e,children:[e," weeks"]},e))}),(0,l.jsx)("button",{type:"button",className:"bg-primary text-primary-foreground px-2 py-1 rounded",onClick:()=>{!h.classId||e.availablePairs.some(e=>e.classId===h.classId&&e.sessionLength===h.sessionLength)||s(e=>e&&{...e,availablePairs:[...e.availablePairs,{...h}]})},children:"Add Pair"})]})]}),(0,l.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,l.jsx)("span",{className:"font-semibold",children:"Pricing Matrix"}),0===e.availablePairs.length?(0,l.jsx)("span",{className:"text-muted-foreground",children:"Add at least one class-session pair to set pricing."}):(0,l.jsx)("div",{className:"overflow-x-auto",children:(0,l.jsxs)("table",{className:"min-w-full text-sm border",children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{className:"p-2 border-b bg-muted",children:"Class"}),(0,l.jsx)("th",{className:"p-2 border-b bg-muted",children:"Session Length"}),(0,l.jsx)("th",{className:"p-2 border-b bg-muted",children:"Price"})]})}),(0,l.jsx)("tbody",{children:e.availablePairs.map(n=>{var i,r,t,d;let c=(null==(i=a.find(e=>e.id===n.classId))?void 0:i.name)||n.classId;return(0,l.jsxs)("tr",{children:[(0,l.jsx)("td",{className:"p-2 border-r font-semibold",children:c}),(0,l.jsxs)("td",{className:"p-2 border-r",children:[n.sessionLength," weeks"]}),(0,l.jsx)("td",{className:"p-2",children:(0,l.jsxs)("div",{className:"flex items-center gap-1",children:[(0,l.jsx)("span",{className:"text-muted-foreground",children:"$"}),(0,l.jsx)("input",{type:"number",min:"0",step:"0.01",className:"w-24 p-1 border rounded",placeholder:"0.00",value:null!=(d=null==(t=e.pricing)||null==(r=t[n.classId])?void 0:r[n.sessionLength])?d:"",onChange:e=>(function(e,a,l){let n=""===l?"":Number(l);s(s=>({...s,pricing:{...s.pricing,[e]:{...s.pricing[e]||{},[a]:n}}}))})(n.classId,n.sessionLength,e.target.value)})]})})]},n.classId+"-"+n.sessionLength)})})]})})]}),(0,l.jsx)("button",{className:"bg-primary text-primary-foreground px-4 py-2 rounded font-semibold w-full disabled:opacity-50",type:"submit",disabled:p,children:p?"Saving...":"Save Facility"})]}),(0,l.jsx)("div",{className:"text-center mt-4",children:(0,l.jsx)(c(),{href:"/admin/facilities",className:"text-primary hover:underline",children:"Back to Facilities"})})]})]})})}}},e=>{var s=s=>e(e.s=s);e.O(0,[992,644,380,537,470,441,684,358],()=>s(1303)),_N_E=e.O()}]);