(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[60],{284:(e,s,a)=>{Promise.resolve().then(a.bind(a,5022))},2773:(e,s,a)=>{"use strict";a.d(s,{A:()=>l});let l=(0,a(157).A)("FolderOpen",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]])},3349:(e,s,a)=>{"use strict";a.d(s,{A:()=>l});let l=(0,a(157).A)("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]])},5022:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>u});var l=a(5155),i=a(2204),n=a(7857),r=a(2298),d=a(5317),t=a(6874),c=a.n(t),o=a(5695),m=a(2115);function u(){let e=(0,o.useRouter)(),s=(0,o.useParams)(),a=Array.isArray(null==s?void 0:s.id)?s.id[0]:null==s?void 0:s.id,[t,u]=(0,m.useState)(null),[x,h]=(0,m.useState)([]),[p,b]=(0,m.useState)(!1),[f,j]=(0,m.useState)({classId:"",sessionLength:5});function g(e){if(!t)return;let{name:s,value:a}=e.target;u(e=>e&&{...e,[s]:a})}async function v(s){if(s.preventDefault(),!t)return;b(!0);let{id:a,...l}=t;await (0,d.mZ)((0,d.H9)(r.db,"facilities",a),l),b(!1),e.push("/admin/facilities")}return(0,m.useEffect)(()=>{!async function(){if(!a)return;let e=(0,d.H9)(r.db,"facilities",a),s=await (0,d.x7)(e);if(s.exists()){let e=s.data();u({id:s.id,...e,availablePairs:e.availablePairs||[],pricing:e.pricing||{}})}}()},[a]),(0,m.useEffect)(()=>{!async function(){let e=(await (0,d.GG)((0,d.rJ)(r.db,"classes"))).docs.map(e=>({id:e.id,...e.data()}));e.sort((e,s)=>e.name.localeCompare(s.name)),h(e)}()},[]),t?(0,l.jsx)(i.AdminAuthGuard,{children:(0,l.jsxs)("div",{children:[(0,l.jsx)(n.AdminHeader,{}),(0,l.jsxs)("main",{className:"container mx-auto px-4 py-12 max-w-4xl",children:[(0,l.jsx)("h1",{className:"text-3xl font-headline font-bold text-primary mb-8 text-center",children:"Edit Facility"}),(0,l.jsxs)("form",{className:"bg-card rounded-lg shadow-md p-6 space-y-4",onSubmit:v,children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Facility Name"}),(0,l.jsx)("input",{className:"w-full p-2 border rounded",name:"name",placeholder:"Enter facility name",value:t.name,onChange:g,required:!0})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Address"}),(0,l.jsx)("input",{className:"w-full p-2 border rounded",name:"address",placeholder:"Enter facility address",value:t.address,onChange:g,required:!0})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Phone Number"}),(0,l.jsx)("input",{className:"w-full p-2 border rounded",name:"phone",placeholder:"Enter phone number",value:t.phone,onChange:g,required:!0})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Registration Code"}),(0,l.jsx)("input",{className:"w-full p-2 border rounded",name:"registrationCode",placeholder:"Enter registration code",value:t.registrationCode,onChange:g,required:!0})]}),(0,l.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,l.jsx)("span",{className:"font-semibold",children:"Class-Session Pairs"}),(0,l.jsx)("div",{className:"space-y-2 mb-2",children:0===t.availablePairs.length?(0,l.jsx)("span",{className:"text-muted-foreground",children:"No pairs added."}):t.availablePairs.map((e,s)=>{var a;let i=(null==(a=x.find(s=>s.id===e.classId))?void 0:a.name)||e.classId;return(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsxs)("span",{children:[i," â€“ ",e.sessionLength," weeks"]}),(0,l.jsx)("button",{type:"button",className:"text-destructive underline text-xs",onClick:()=>{u(e=>e&&{...e,availablePairs:e.availablePairs.filter((e,a)=>a!==s)})},children:"Remove"})]},s)})}),(0,l.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,l.jsxs)("select",{className:"p-2 border rounded",value:f.classId,onChange:e=>j(s=>({...s,classId:e.target.value})),children:[(0,l.jsx)("option",{value:"",disabled:!0,children:"Select Class"}),x.map(e=>(0,l.jsx)("option",{value:e.id,children:e.name},e.id))]}),(0,l.jsx)("select",{className:"p-2 border rounded",value:f.sessionLength,onChange:e=>j(s=>({...s,sessionLength:Number(e.target.value)})),children:[5,6,7,8].map(e=>(0,l.jsxs)("option",{value:e,children:[e," weeks"]},e))}),(0,l.jsx)("button",{type:"button",className:"bg-primary text-primary-foreground px-2 py-1 rounded",onClick:()=>{!f.classId||t.availablePairs.some(e=>e.classId===f.classId&&e.sessionLength===f.sessionLength)||u(e=>e&&{...e,availablePairs:[...e.availablePairs,{...f}]})},children:"Add Pair"})]})]}),(0,l.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,l.jsx)("span",{className:"font-semibold",children:"Pricing Matrix"}),0===t.availablePairs.length?(0,l.jsx)("span",{className:"text-muted-foreground",children:"Add at least one class-session pair to set pricing."}):(0,l.jsx)("div",{className:"overflow-x-auto",children:(0,l.jsxs)("table",{className:"min-w-full text-sm border",children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{className:"p-2 border-b bg-muted",children:"Class"}),(0,l.jsx)("th",{className:"p-2 border-b bg-muted",children:"Session Length"}),(0,l.jsx)("th",{className:"p-2 border-b bg-muted",children:"Price"})]})}),(0,l.jsx)("tbody",{children:t.availablePairs.map(e=>{var s,a,i,n;let r=(null==(s=x.find(s=>s.id===e.classId))?void 0:s.name)||e.classId;return(0,l.jsxs)("tr",{children:[(0,l.jsx)("td",{className:"p-2 border-r font-semibold",children:r}),(0,l.jsxs)("td",{className:"p-2 border-r",children:[e.sessionLength," weeks"]}),(0,l.jsx)("td",{className:"p-2",children:(0,l.jsxs)("div",{className:"flex items-center gap-1",children:[(0,l.jsx)("span",{className:"text-muted-foreground",children:"$"}),(0,l.jsx)("input",{type:"number",min:"0",step:"0.01",className:"w-24 p-1 border rounded",placeholder:"0.00",value:null!=(n=null==(i=t.pricing)||null==(a=i[e.classId])?void 0:a[e.sessionLength])?n:"",onChange:s=>(function(e,s,a){if(!t)return;let l=""===a?0:Number(a);u(a=>a?{...a,pricing:{...a.pricing,[e]:{...a.pricing[e],[s]:l}}}:a)})(e.classId,e.sessionLength,s.target.value)})]})})]},e.classId+"-"+e.sessionLength)})})]})})]}),(0,l.jsx)("button",{className:"bg-primary text-primary-foreground px-4 py-2 rounded font-semibold w-full disabled:opacity-50",type:"submit",disabled:p,children:p?"Saving...":"Save Changes"})]}),(0,l.jsx)("div",{className:"text-center mt-4",children:(0,l.jsx)(c(),{href:"/admin/facilities",className:"text-primary hover:underline",children:"Back to Facilities"})})]})]})}):(0,l.jsx)(i.AdminAuthGuard,{children:(0,l.jsxs)("div",{children:[(0,l.jsx)(n.AdminHeader,{}),(0,l.jsxs)("main",{className:"container mx-auto px-4 py-12 max-w-xl",children:[(0,l.jsx)("h1",{className:"text-3xl font-headline font-bold text-primary mb-8 text-center",children:"Edit Facility"}),(0,l.jsx)("p",{children:"Loading..."})]})]})})}}},e=>{var s=s=>e(e.s=s);e.O(0,[992,644,380,537,470,441,684,358],()=>s(284)),_N_E=e.O()}]);