(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[798],{2773:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(157).A)("FolderOpen",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]])},3349:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(157).A)("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]])},9662:(e,s,t)=>{Promise.resolve().then(t.bind(t,9720))},9720:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>m});var a=t(5155),l=t(2204),d=t(7857),r=t(2298),n=t(5317),i=t(6874),c=t.n(i),o=t(5695),u=t(2115);function m(){let[e,s]=(0,u.useState)([]),[t,i]=(0,u.useState)(!0),[m,h]=(0,u.useState)(""),[x,p]=(0,u.useState)("all"),[j,f]=(0,u.useState)("30");async function b(t){if(confirm("Are you sure you want to process a refund for this order?")){let a=(0,n.H9)(r.db,"orders",t);await (0,n.mZ)(a,{status:"refunded"}),s(e.map(e=>e.id===t?{...e,status:"refunded"}:e))}}(0,o.useRouter)(),(0,u.useEffect)(()=>{!async function(){i(!0),s((await (0,n.GG)((0,n.rJ)(r.db,"orders"))).docs.map(e=>({id:e.id,...e.data()}))),i(!1)}()},[]);let N=e.filter(e=>{if("all"!==j&&!function(e,s){let t=new Date,a=new Date(e);return(t.getTime()-a.getTime())/864e5<=s}(e.createdAt,Number(j))||"all"!==x&&e.status!==x)return!1;let s=m.toLowerCase();return!s||!!e.parentName.toLowerCase().includes(s)||!!e.parentEmail.toLowerCase().includes(s)||!!e.items.some(e=>e.childName&&e.childName.toLowerCase().includes(s)||e.classId&&e.classId.toLowerCase().includes(s))||!!e.status.toLowerCase().includes(s)});return(0,a.jsx)(l.AdminAuthGuard,{children:(0,a.jsxs)("div",{children:[(0,a.jsx)(d.AdminHeader,{}),(0,a.jsxs)("main",{className:"container mx-auto px-4 py-12",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-8",children:[(0,a.jsx)("h1",{className:"text-3xl font-headline font-bold text-primary",children:"Manage Orders"}),(0,a.jsx)(c(),{href:"/admin/orders/new",className:"bg-primary text-primary-foreground px-4 py-2 rounded font-semibold hover:bg-primary/90 transition",children:"Add Order"})]}),(0,a.jsxs)("div",{className:"mb-4 flex flex-wrap gap-4 items-end",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-semibold mb-1",children:"Search"}),(0,a.jsx)("input",{className:"p-2 border rounded w-48",placeholder:"Parent, email, child, class, status...",value:m,onChange:e=>h(e.target.value)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-semibold mb-1",children:"Status"}),(0,a.jsxs)("select",{className:"p-2 border rounded",value:x,onChange:e=>p(e.target.value),children:[(0,a.jsx)("option",{value:"all",children:"All"}),(0,a.jsx)("option",{value:"pending",children:"Pending"}),(0,a.jsx)("option",{value:"paid",children:"Paid"}),(0,a.jsx)("option",{value:"refunded",children:"Refunded"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-semibold mb-1",children:"Date"}),(0,a.jsxs)("select",{className:"p-2 border rounded",value:j,onChange:e=>f(e.target.value),children:[(0,a.jsx)("option",{value:"all",children:"All Time"}),(0,a.jsx)("option",{value:"1",children:"Last 1 day"}),(0,a.jsx)("option",{value:"7",children:"Last 7 days"}),(0,a.jsx)("option",{value:"30",children:"Last 30 days"})]})]})]}),(0,a.jsxs)("div",{className:"bg-card rounded-lg shadow-md p-6",children:[(0,a.jsx)("h2",{className:"font-bold text-xl mb-4",children:"Orders List"}),t?(0,a.jsx)("p",{children:"Loading..."}):0===N.length?(0,a.jsx)("p",{className:"text-muted-foreground mb-4",children:"No orders found."}):(0,a.jsxs)("table",{className:"min-w-full text-sm",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"text-left p-2",children:"Parent"}),(0,a.jsx)("th",{className:"text-left p-2",children:"Email"}),(0,a.jsx)("th",{className:"text-left p-2",children:"Items"}),(0,a.jsx)("th",{className:"text-left p-2",children:"Total"}),(0,a.jsx)("th",{className:"text-left p-2",children:"Status"}),(0,a.jsx)("th",{className:"text-left p-2",children:"Created"}),(0,a.jsx)("th",{className:"text-left p-2",children:"Actions"})]})}),(0,a.jsx)("tbody",{children:N.map(e=>(0,a.jsxs)("tr",{className:"border-t",children:[(0,a.jsx)("td",{className:"p-2",children:e.parentName}),(0,a.jsx)("td",{className:"p-2",children:e.parentEmail}),(0,a.jsxs)("td",{className:"p-2",children:[e.items.length," item",1!==e.items.length?"s":""]}),(0,a.jsxs)("td",{className:"p-2",children:["$",e.totalAmount.toFixed(2)]}),(0,a.jsx)("td",{className:"p-2",children:(0,a.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat("paid"===e.status?"bg-green-100 text-green-800":"pending"===e.status?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"),children:e.status.charAt(0).toUpperCase()+e.status.slice(1)})}),(0,a.jsx)("td",{className:"p-2",children:new Date(e.createdAt).toLocaleDateString()}),(0,a.jsx)("td",{className:"p-2 flex gap-2",children:(0,a.jsx)("button",{className:"bg-orange-500 text-white px-2 py-1 rounded hover:bg-orange-600",onClick:()=>b(e.id),disabled:"refunded"===e.status,children:"Refund"})})]},e.id))})]})]})]})]})})}}},e=>{var s=s=>e(e.s=s);e.O(0,[992,644,380,537,470,441,684,358],()=>s(9662)),_N_E=e.O()}]);