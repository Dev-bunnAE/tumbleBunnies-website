(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[88,706],{2501:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>y});var l=a(5155),r=a(2204),n=a(7857),i=a(2298),s=a(7706),o=a(1671),c=a(279),d=a(5317),u=a(858),m=a(6766),p=a(6874),f=a.n(p),g=a(5695),h=a(2115),v=a(3159);let x=["Any","0-1","2-3","4-5","6-7","8-10"];function y(){let[e,t]=(0,h.useState)({name:"",ageRange:x[0],imageUrl:""}),[a,p]=(0,h.useState)(!1),[y,S]=(0,h.useState)(""),[b,j]=(0,h.useState)(null),[w,N]=(0,h.useState)({x:0,y:0}),[C,A]=(0,h.useState)(1),[z,R]=(0,h.useState)(!1),k=(0,h.useRef)(null),I=(0,g.useRouter)(),[E,T]=(0,h.useState)(""),[U,M]=(0,h.useState)(!1);function P(e){let{name:a,value:l}=e.target;t(e=>({...e,[a]:l}))}async function _(){if(y&&b){M(!0),T("");try{let e=await new Promise((e,t)=>{let a=new window.Image;a.crossOrigin="anonymous",a.src=y,a.onload=()=>{let l=document.createElement("canvas");l.width=400,l.height=400;let r=l.getContext("2d");if(!r)return t(Error("Canvas context is null"));let n=a.width/a.naturalWidth,i=b.x*n,s=b.y*n;r.drawImage(a,i,s,b.width*n,b.height*n,0,0,400,400),l.toBlob(a=>{if(!a)return void t(Error("Canvas is empty"));e(a)},"image/jpeg",.95)},a.onerror=e=>t(e)}),a=(0,u.c7)(),l=(0,u.KR)(a,"class-images/".concat(Date.now(),".jpg"));await (0,u.D)(l,e);let r=await (0,u.qk)(l);t(e=>({...e,imageUrl:r})),R(!1)}catch(e){T("Failed to upload image. Please try again.")}M(!1)}}async function D(t){if(t.preventDefault(),!e.imageUrl)return void T("Please upload and crop a class image.");p(!0);let{name:a,ageRange:l,imageUrl:r}=e;await (0,d.gS)((0,d.rJ)(i.db,"classes"),{name:a,ageRange:l,imageUrl:r}),p(!1),I.push("/admin/classes")}return(0,l.jsx)(r.AdminAuthGuard,{children:(0,l.jsxs)("div",{children:[(0,l.jsx)(n.AdminHeader,{}),(0,l.jsxs)("main",{className:"container mx-auto px-4 py-12 max-w-xl",children:[(0,l.jsx)("h1",{className:"text-3xl font-headline font-bold text-primary mb-8 text-center",children:"Add Class"}),(0,l.jsxs)("form",{className:"bg-card rounded-lg shadow-md p-6 space-y-4",onSubmit:D,children:[(0,l.jsx)("input",{className:"w-full p-2 border rounded",name:"name",placeholder:"Class Name",value:e.name,onChange:P,required:!0}),(0,l.jsxs)("select",{className:"w-full p-2 border rounded",name:"ageRange",value:e.ageRange,onChange:P,required:!0,children:[(0,l.jsx)("option",{value:"",disabled:!0,children:"Select Age Range"}),x.map(e=>(0,l.jsx)("option",{value:e,children:"Any"===e?"Any":"".concat(e," years")},e))]}),(0,l.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,l.jsx)("span",{className:"font-semibold",children:"Class Image"}),(0,l.jsxs)("div",{className:"flex gap-4 items-center",children:[(0,l.jsx)("input",{type:"file",accept:"image/jpeg,image/png",ref:k,onChange:function(e){let t;if(T(""),"dataTransfer"in e&&e.dataTransfer&&e.dataTransfer.files&&e.dataTransfer.files.length>0?t=e.dataTransfer.files[0]:"target"in e&&e.target&&e.target.files&&e.target.files.length>0&&(t=e.target.files[0]),!t)return;if(!["image/jpeg","image/png"].includes(t.type))return void T("Only JPEG and PNG images are allowed.");if(t.size>0xa00000)return void T("Image must be less than 10MB.");let a=new FileReader;a.addEventListener("load",()=>{S(a.result),R(!0)}),a.readAsDataURL(t)},className:"hidden"}),(0,l.jsxs)("button",{type:"button",className:"bg-primary text-primary-foreground px-4 py-2 rounded font-semibold",onClick:()=>{var e;return null==(e=k.current)?void 0:e.click()},children:[(0,l.jsx)(s.default,{className:"inline mr-2"})," Upload Image"]}),e.imageUrl&&(0,l.jsx)(m.default,{src:e.imageUrl,alt:"Class image",width:64,height:64,className:"h-16 w-16 object-cover rounded"})]}),E&&(0,l.jsx)("p",{className:"text-destructive text-sm mt-2",children:E}),z&&(0,l.jsxs)("div",{className:"relative w-full h-64 bg-muted rounded mt-4",children:[(0,l.jsx)(v.Ay,{image:y,crop:w,zoom:C,aspect:1,onCropChange:N,onZoomChange:A,onCropComplete:function(e,t){j(t)}}),(0,l.jsxs)("div",{className:"absolute bottom-4 left-0 right-0 flex flex-col items-center",children:[(0,l.jsx)(c.Ay,{min:1,max:3,step:.01,value:C,onChange:(e,t)=>A(t),className:"w-1/2"}),(0,l.jsx)("button",{type:"button",className:"mt-2 bg-primary text-primary-foreground px-4 py-2 rounded font-semibold",onClick:_,disabled:U,children:U?(0,l.jsx)(o.A,{size:20}):"Crop & Upload"})]})]})]}),(0,l.jsx)("button",{className:"bg-primary text-primary-foreground px-4 py-2 rounded font-semibold w-full disabled:opacity-50",type:"submit",disabled:a,children:a?"Saving...":"Save Class"})]}),(0,l.jsx)("div",{className:"text-center mt-4",children:(0,l.jsx)(f(),{href:"/admin/classes",className:"text-primary hover:underline",children:"Back to Classes"})})]})]})})}},7706:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>v});var l=a(2115),r=a(2596),n=a(7472),i=a(3209),s=a(7807),o=a(680),c=a(9823),d=a(5170),u=a(306);function m(e){return(0,u.Ay)("MuiSvgIcon",e)}(0,d.A)("MuiSvgIcon",["root","colorPrimary","colorSecondary","colorAction","colorError","colorDisabled","fontSizeInherit","fontSizeSmall","fontSizeMedium","fontSizeLarge"]);var p=a(5155);let f=e=>{let{color:t,fontSize:a,classes:l}=e,r={root:["root","inherit"!==t&&"color".concat((0,i.A)(t)),"fontSize".concat((0,i.A)(a))]};return(0,n.A)(r,m,l)},g=(0,s.Ay)("svg",{name:"MuiSvgIcon",slot:"Root",overridesResolver:(e,t)=>{let{ownerState:a}=e;return[t.root,"inherit"!==a.color&&t["color".concat((0,i.A)(a.color))],t["fontSize".concat((0,i.A)(a.fontSize))]]}})((0,o.A)(e=>{var t,a,l,r,n,i,s,o,c,d,u,m,p,f,g,h,v,x;let{theme:y}=e;return{userSelect:"none",width:"1em",height:"1em",display:"inline-block",flexShrink:0,transition:null==(r=y.transitions)||null==(l=r.create)?void 0:l.call(r,"fill",{duration:null==(a=(null!=(g=y.vars)?g:y).transitions)||null==(t=a.duration)?void 0:t.shorter}),variants:[{props:e=>!e.hasSvgAsChild,style:{fill:"currentColor"}},{props:{fontSize:"inherit"},style:{fontSize:"inherit"}},{props:{fontSize:"small"},style:{fontSize:(null==(i=y.typography)||null==(n=i.pxToRem)?void 0:n.call(i,20))||"1.25rem"}},{props:{fontSize:"medium"},style:{fontSize:(null==(o=y.typography)||null==(s=o.pxToRem)?void 0:s.call(o,24))||"1.5rem"}},{props:{fontSize:"large"},style:{fontSize:(null==(d=y.typography)||null==(c=d.pxToRem)?void 0:c.call(d,35))||"2.1875rem"}},...Object.entries((null!=(h=y.vars)?h:y).palette).filter(e=>{let[,t]=e;return t&&t.main}).map(e=>{var t,a,l;let[r]=e;return{props:{color:r},style:{color:null==(a=(null!=(l=y.vars)?l:y).palette)||null==(t=a[r])?void 0:t.main}}}),{props:{color:"action"},style:{color:null==(m=(null!=(v=y.vars)?v:y).palette)||null==(u=m.action)?void 0:u.active}},{props:{color:"disabled"},style:{color:null==(f=(null!=(x=y.vars)?x:y).palette)||null==(p=f.action)?void 0:p.disabled}},{props:{color:"inherit"},style:{color:void 0}}]}})),h=l.forwardRef(function(e,t){let a=(0,c.b)({props:e,name:"MuiSvgIcon"}),{children:n,className:i,color:s="inherit",component:o="svg",fontSize:d="medium",htmlColor:u,inheritViewBox:m=!1,titleAccess:h,viewBox:v="0 0 24 24",...x}=a,y=l.isValidElement(n)&&"svg"===n.type,S={...a,color:s,component:o,fontSize:d,instanceFontSize:e.fontSize,inheritViewBox:m,viewBox:v,hasSvgAsChild:y},b={};m||(b.viewBox=v);let j=f(S);return(0,p.jsxs)(g,{as:o,className:(0,r.A)(j.root,i),focusable:"false",color:u,"aria-hidden":!h||void 0,role:h?"img":void 0,ref:t,...b,...x,...y&&n.props,ownerState:S,children:[y?n.props.children:n,h?(0,p.jsx)("title",{children:h}):null]})});h.muiName="SvgIcon";let v=function(e,t){function a(t,a){return(0,p.jsx)(h,{"data-testid":void 0,ref:a,...t,children:e})}return a.muiName=h.muiName,l.memo(l.forwardRef(a))}([(0,p.jsx)("circle",{cx:"12",cy:"12",r:"3.2"},"0"),(0,p.jsx)("path",{d:"M9 2 7.17 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2h-3.17L15 2zm3 15c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5"},"1")],0)},9134:(e,t,a)=>{Promise.resolve().then(a.bind(a,2501))}},e=>{var t=t=>e(e.s=t);e.O(0,[992,644,380,537,766,998,660,991,671,470,441,684,358],()=>t(9134)),_N_E=e.O()}]);