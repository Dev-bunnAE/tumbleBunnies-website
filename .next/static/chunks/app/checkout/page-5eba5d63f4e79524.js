(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[279],{2883:(e,s,t)=>{Promise.resolve().then(t.bind(t,4435))},3330:(e,s,t)=>{"use strict";t.d(s,{U:()=>g});var a=t(5155),r=t(285),l=t(4838),c=t(4469),i=t(7481),n=t(2298),o=t(4815),d=t(1721),m=t(3349),x=t(6766),u=t(6874),h=t.n(u),p=t(5695);function g(){let{user:e,logout:s}=(0,n.useAuth)(),{items:t}=(0,c._)();(0,p.usePathname)();let u=(0,p.useRouter)(),{toast:g}=(0,i.dj)(),j=async()=>{try{await s(),g({title:"Logged Out",description:"You have been successfully logged out."}),u.push("/")}catch(e){g({variant:"destructive",title:"Logout Failed",description:"Please try again."})}},f=()=>t.reduce((e,s)=>e+s.quantity,0);return(0,a.jsx)("header",{className:"bg-background/95 backdrop-blur-sm sticky top-0 z-40 border-b shadow-sm",children:(0,a.jsxs)("div",{className:"container mx-auto px-4 flex justify-between items-center h-16",children:[(0,a.jsxs)(h(),{href:"/",className:"flex items-center gap-2 hover:opacity-80 transition-opacity",children:[(0,a.jsx)(x.default,{src:"https://placehold.co/40x40.png",width:40,height:40,alt:"TumbleBunnies Logo","data-ai-hint":"bunny logo"}),(0,a.jsx)("span",{className:"font-headline text-2xl font-bold text-primary",children:"TumbleBunnies"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)(r.$,{variant:"ghost",size:"icon",className:"relative cursor-pointer","aria-label":"Shopping Cart",onClick:()=>{console.log("Cart clicked, navigating to checkout..."),u.push("/checkout")},children:[(0,a.jsx)(o.A,{className:"h-5 w-5"}),f()>0&&(0,a.jsx)("span",{className:"absolute -top-1 -right-1 bg-primary text-primary-foreground rounded-full h-5 w-5 text-xs flex items-center justify-center font-medium",children:f()})]}),e&&(0,a.jsxs)(l.rI,{children:[(0,a.jsx)(l.ty,{asChild:!0,children:(0,a.jsx)(r.$,{variant:"ghost",size:"icon","aria-label":"User Account",children:(0,a.jsx)(d.A,{className:"h-5 w-5"})})}),(0,a.jsxs)(l.SQ,{align:"end",className:"w-56",children:[(0,a.jsx)(l.lp,{className:"font-normal",children:(0,a.jsxs)("div",{className:"flex flex-col space-y-1",children:[(0,a.jsx)("p",{className:"text-sm font-medium leading-none",children:e.email}),(0,a.jsx)("p",{className:"text-xs leading-none text-muted-foreground",children:e.displayName||"User"})]})}),(0,a.jsx)(l.mB,{}),(0,a.jsx)(l._2,{asChild:!0,children:(0,a.jsxs)(h(),{href:"/account",className:"flex items-center gap-2",children:[(0,a.jsx)(d.A,{className:"h-4 w-4"}),"My Profile"]})}),(0,a.jsx)(l._2,{asChild:!0,children:(0,a.jsxs)(h(),{href:"/orders",className:"flex items-center gap-2",children:[(0,a.jsx)(o.A,{className:"h-4 w-4"}),"My Orders"]})}),(0,a.jsx)(l.mB,{}),(0,a.jsxs)(l._2,{onSelect:j,className:"text-destructive focus:text-destructive",children:[(0,a.jsx)(m.A,{className:"h-4 w-4 mr-2"}),"Logout"]})]})]})]})]})})}},3349:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(157).A)("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]])},4435:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>h});var a=t(5155),r=t(3330),l=t(285),c=t(6695),i=t(4469),n=t(2298),o=t(4815),d=t(1721);let m=(0,t(157).A)("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);var x=t(5695),u=t(2115);function h(){let{items:e,removeItem:s,clearCart:t}=(0,i._)(),{user:h}=(0,n.useAuth)(),[p,g]=(0,u.useState)(""),[j,f]=(0,u.useState)(""),[y,N]=(0,u.useState)(!1),[b,v]=(0,u.useState)(!1),w=(0,x.useRouter)(),k=e.reduce((e,s)=>e+s.price*s.quantity,0);async function C(s){s.preventDefault(),N(!0);try{console.log("Starting checkout process..."),console.log("User:",null==h?void 0:h.email),console.log("Items:",e),console.log("Total:",k);let s={parentName:p,parentEmail:(null==h?void 0:h.email)||"",totalAmount:k,items:e.map(e=>({classId:e.classId||"",childName:e.childName||"",sessionLength:e.sessionLength||0,price:e.price}))};console.log("Order data to save:",s);let a=await fetch("/api/orders/create",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(!a.ok){let e=await a.json();throw Error(e.error||"Failed to create order")}let r=await a.json();console.log("Order saved successfully with ID:",r.orderId),setTimeout(()=>{N(!1),v(!0),t(),setTimeout(()=>w.push("/orders"),2e3)},1500)}catch(e){console.error("Error saving order:",e),console.error("Error details:",{message:e.message,code:e.code,stack:e.stack}),N(!1),alert("Error saving order: ".concat(e.message))}}return b?(0,a.jsxs)("main",{className:"container mx-auto px-4 py-12 max-w-lg text-center",children:[(0,a.jsx)(r.U,{}),(0,a.jsxs)(c.Zp,{className:"shadow-xl",children:[(0,a.jsx)(c.aR,{children:(0,a.jsx)(c.ZB,{className:"text-2xl font-bold text-primary",children:"Thank you!"})}),(0,a.jsxs)(c.Wu,{children:[(0,a.jsx)("p",{className:"mb-4 text-muted-foreground",children:"Your order has been placed successfully. You'll receive a confirmation email soon."}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Redirecting to your orders..."})]})]})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(r.U,{}),(0,a.jsxs)("main",{className:"container mx-auto px-4 py-12 max-w-2xl",children:[(0,a.jsxs)("div",{className:"text-center mb-8",children:[(0,a.jsx)("h1",{className:"text-3xl font-headline font-bold text-primary mb-2",children:"Checkout"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Review your cart and complete your purchase"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[(0,a.jsxs)(c.Zp,{className:"shadow-lg",children:[(0,a.jsx)(c.aR,{children:(0,a.jsxs)(c.ZB,{className:"flex items-center gap-2",children:[(0,a.jsx)(o.A,{className:"w-5 h-5"}),"Cart Items"]})}),(0,a.jsx)(c.Wu,{children:0===e.length?(0,a.jsxs)("div",{className:"text-center py-8 text-muted-foreground",children:[(0,a.jsx)(o.A,{className:"w-12 h-12 mx-auto mb-4 text-muted-foreground/50"}),(0,a.jsx)("p",{children:"Your cart is empty."})]}):(0,a.jsxs)("div",{className:"space-y-4",children:[e.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 bg-muted/30 rounded-lg border",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("div",{className:"font-semibold text-primary",children:e.name}),e.childName&&(0,a.jsxs)("div",{className:"flex items-center gap-1 text-sm text-muted-foreground mt-1",children:[(0,a.jsx)(d.A,{className:"w-3 h-3"}),(0,a.jsxs)("span",{children:["For ",e.childName]})]}),(0,a.jsxs)("div",{className:"text-sm text-muted-foreground mt-1",children:["$",e.price.toFixed(2)," x ",e.quantity]})]}),(0,a.jsx)(l.$,{size:"sm",variant:"ghost",onClick:()=>s(e.id),className:"text-destructive hover:text-destructive",children:"Remove"})]},e.id)),(0,a.jsxs)("div",{className:"flex justify-between font-bold text-lg pt-4 border-t",children:[(0,a.jsx)("span",{children:"Total"}),(0,a.jsxs)("span",{className:"text-primary",children:["$",k.toFixed(2)]})]})]})})]}),(0,a.jsxs)(c.Zp,{className:"shadow-lg",children:[(0,a.jsx)(c.aR,{children:(0,a.jsxs)(c.ZB,{className:"flex items-center gap-2",children:[(0,a.jsx)(m,{className:"w-5 h-5"}),"Payment Details"]})}),(0,a.jsx)(c.Wu,{children:0===e.length?(0,a.jsxs)("div",{className:"text-center py-8 text-muted-foreground",children:[(0,a.jsx)(m,{className:"w-12 h-12 mx-auto mb-4 text-muted-foreground/50"}),(0,a.jsx)("p",{children:"Add items to your cart to proceed with checkout."})]}):(0,a.jsxs)("form",{className:"space-y-4",onSubmit:C,children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block font-medium mb-2",children:"Name on Card"}),(0,a.jsx)("input",{className:"w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary",value:p,onChange:e=>g(e.target.value),required:!0,placeholder:"John Doe"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block font-medium mb-2",children:"Card Number"}),(0,a.jsx)("input",{className:"w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary",value:j,onChange:e=>f(e.target.value),required:!0,placeholder:"1234 5678 9012 3456"})]}),(0,a.jsx)(l.$,{type:"submit",className:"w-full bg-primary hover:bg-primary/90 text-primary-foreground font-semibold",disabled:y,children:y?"Processing...":"Place Order - $".concat(k.toFixed(2))})]})})]})]})]})]})}},4815:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(157).A)("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]])}},e=>{var s=s=>e(e.s=s);e.O(0,[992,644,380,537,766,123,441,684,358],()=>s(2883)),_N_E=e.O()}]);